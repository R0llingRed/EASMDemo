"""Tests for vulnerability severity mapping."""
from enum import Enum


class Severity(str, Enum):
    """Vulnerability severity levels."""
    critical = "critical"
    high = "high"
    medium = "medium"
    low = "low"
    info = "info"


def _map_severity(severity: str) -> str:
    """Map nuclei severity to standard severity."""
    severity_map = {
        "critical": "critical",
        "high": "high",
        "medium": "medium",
        "low": "low",
        "info": "info",
        "unknown": "info",
    }
    return severity_map.get(severity.lower(), "info")


class TestSeverityMapping:
    """Tests for severity mapping."""

    def test_critical_severity(self):
        assert _map_severity("critical") == "critical"

    def test_high_severity(self):
        assert _map_severity("high") == "high"

    def test_medium_severity(self):
        assert _map_severity("medium") == "medium"

    def test_low_severity(self):
        assert _map_severity("low") == "low"

    def test_info_severity(self):
        assert _map_severity("info") == "info"

    def test_unknown_severity(self):
        assert _map_severity("unknown") == "info"

    def test_case_insensitive(self):
        assert _map_severity("CRITICAL") == "critical"
        assert _map_severity("High") == "high"

    def test_invalid_severity(self):
        assert _map_severity("invalid") == "info"
